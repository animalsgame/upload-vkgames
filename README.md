# Скрипт для загрузки игр на хостинг вк
Что такое хостинг вк - можно почитать в документации https://dev.vk.com/ru/games/development/hosting/overview  
Как минимум вам нужно знать что такое npm, как устанавливать модули, то решение подойдёт не всем...

## Этот скрипт создан чтобы не было сложностей с установкой, и есть много отличий!
- Скрипт не использует сторонние модули, нужно только установить nodejs (можно не устанавливать в систему)
- Для создания zip архива используются известные архиваторы, которые уже обычно установлены.
- Чтобы получить токен не нужно копировать ссылку, браузер который по умолчанию сам откроет ссылку, и остаётся нажать одну кнопку.
- История публикаций, вы можете смотреть url после публикации, а ещё версии, и даты. Всё это пишется в обычный текстовый файл.
- Вы можете указать путь к папке с игрой, либо путь к файлу zip, тогда скрипт не будет упаковывать содержимое в zip архив, а сразу пойдёт загрузка zip на хостинг.

# Установка
Скачайте этот проект, можно по прямой ссылке https://github.com/animalsgame/upload-vkgames/archive/refs/heads/main.zip и перенесите папку в удобное место.

### Windows
#### Установите nodejs https://nodejs.org
Выберите подходящую версию для windows. 
Либо вы можете не устанавливать, а скачать например эту версию https://nodejs.org/dist/v22.13.0/node-v22.13.0-win-x86.zip (32 бита) и взять из архива только файл `node.exe` его надо перенести в папку где находится этот проект.

#### Установка архиватора
Скрипт ищет архиватор 7-Zip или WinRAR  
Сайт 7-Zip https://www.7-zip.org  

Если ему не удаётся найти (может архиватор установлен не в Program Files) есть запасной вариант - указать папку где находится архиватор, в скрипте найдите `const zipWindowsFolder` и укажите путь.

### Linux
Установка nodejs `apt-get install nodejs`  
Архиватор, скрипт ищет 7-Zip или zip, если нужно установить - `apt-get install p7zip-full` или `apt-get install zip`

### MacOS
Проверить работу скрипта не получается, удалось найти вот что:  
Установка nodejs `brew install node`  
Архиватор `brew install p7zip` или `brew install sevenzip`

# Запуск и публикация игр
Вы уже можете запустить `run.bat` (если windows) либо `sh run.sh` по умолчанию id приложения 0, но скрипт предложит указать id (это если не хочется редактировать run файл)  
А вообще откройте run файл в редакторе, и познакомьтесь:  
`APP_ID` - id приложения, желательно указать, тогда скрипт не будет предлагать вводить id  
`APP_ENV` - куда публиковать, если указан prod тогда требуется подтверждение через код или push. Если нужен только dev, вы можете не удалять prod, а добавить в конце букву d, чтобы было уже prodd  
`APP_ENDPOINTS` - платформы, через = указывается файл, для каждой платформы можно указывать стартовый файл, но по умолчанию для всех платформ `index.html`  
Всего 3 платформы `web -> vk.com` `mvk -> m.vk.com` `mobile -> iOS & Android`  
`APP_PATH` - путь к папке с игрой (по умолчанию тестовое приложение, оно в папке testapp) всё содержимое будет упаковано в zip архив, либо укажите путь к zip файлу, тогда упаковка будет не нужна! Это может сильно выручить если много файлов и есть уже архив, вы можете обновить файлы в архиве, и не придётся тратить время на упаковку.

#### Запускайте run и публикация началась!   
Если ещё не получили токен, откроется вкладка в браузере, после подтверждения токен запишется в файл `token.txt` и не будет запрашиваться больше (пока не истечёт)  
После публикации в папке `builds` будет zip файл с игрой `appID.zip` и файл с историей `history_appID.txt`

# Прочее...
Из-за различных версий nodejs и операционных систем, может возникнуть проблема с сертификатами при обращении к серверу (особенно если windows 8 и ниже) на всякий случай в скрипт добавлено `{rejectUnauthorized:false}` вообще это не рекомендуется, если уверены что с сертификатами проблем нет - замените на `{}`
#### Тестировалось на windows 8.1, ubuntu 14, а вот на windows xp не запустился из-за async функций, а новее nodejs нет для xp(
